# CAN Bus 異常標記定義

anomaly_types:
  - name: "數據長度不匹配"
    description: "實際數據長度與聲明的長度不一致"
    severity: "高"
    detection:
      - condition: "實際數據長度 != 聲明長度"
      - example: "聲明長度為 8，但實際數據長度為 9"

  - name: "無效數據"
    description: "數據包含非法值或格式"
    severity: "中"
    detection:
      - condition: "數據包含非十六進制字符"
      - example: "數據包含 'XX' 或 'YY' 等無效值"

  - name: "異常頻率"
    description: "消息發送頻率異常"
    severity: "低"
    detection:
      - condition: "相同 ID 的消息間隔時間異常"
      - example: "正常間隔 100ms，但實際間隔 10ms"

  - name: "未授權 ID"
    description: "檢測到未授權的 CAN ID"
    severity: "高"
    detection:
      - condition: "CAN ID 不在白名單中"
      - example: "檢測到未註冊的 ID 0x999"

message_patterns:
  - id: "0x123"
    normal_length: 8
    expected_interval: 100 # ms
    allowed_values: "00-FF"

  - id: "0x456"
    normal_length: 4
    expected_interval: 50 # ms
    allowed_values: "00-FF"

  - id: "0x789"
    normal_length: 2
    expected_interval: 200 # ms
    allowed_values: "00-FF"
